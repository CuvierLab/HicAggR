<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Import Hic data — ImportHiC • HicAggR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import Hic data — ImportHiC"><meta name="description" content="Import ..hic, .cool, .mcool or .bedpe data"><meta property="og:description" content="Import ..hic, .cool, .mcool or .bedpe data"><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HicAggR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/HicAggR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/InDepth.html">HicAggR - In depth tutorial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CuvierLab/HicAggR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Import Hic data</h1>
      <small class="dont-index">Source: <a href="https://github.com/CuvierLab/HicAggR/blob/master/R/ImportHiC.R" class="external-link"><code>R/ImportHiC.R</code></a></small>
      <div class="d-none name"><code>ImportHiC.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Import ..hic, .cool, .mcool or .bedpe data</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ImportHiC</span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hicResolution <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chromSizes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chrom_1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chrom_2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  hic_norm <span class="op">=</span> <span class="st">"NONE"</span>,</span>
<span>  hic_matrix <span class="op">=</span> <span class="st">"observed"</span>,</span>
<span>  cool_balanced <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cool_weight_name <span class="op">=</span> <span class="st">"weight"</span>,</span>
<span>  cool_divisive_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  h5_fill_upper <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>&lt;GRanges or PairsGRanges or GInteractions&gt;:
The genomic feature on which compute the extraction of HiC submatrix.
Extension should be .hic, .cool, .mcool, .h5, .hdf5, .HDF5 or .bedpe"
assuming .h5 and .hdf5 are only for cool (not mcool).</p></dd>


<dt id="arg-hicresolution">hicResolution<a class="anchor" aria-label="anchor" href="#arg-hicresolution"></a></dt>
<dd><p><numeric>: The HiC resolution.</numeric></p></dd>


<dt id="arg-chromsizes">chromSizes<a class="anchor" aria-label="anchor" href="#arg-chromsizes"></a></dt>
<dd><p>&lt;data.frame&gt;: A data.frame where first
colum correspond to the chromosomes names, and the second column correspond
to the chromosomes lengths in base pairs.</p></dd>


<dt id="arg-chrom-">chrom_1<a class="anchor" aria-label="anchor" href="#arg-chrom-"></a></dt>
<dd><p><numeric>: The seqnames of first chromosmes
(rows in matrix).</numeric></p></dd>


<dt id="arg-chrom-">chrom_2<a class="anchor" aria-label="anchor" href="#arg-chrom-"></a></dt>
<dd><p><numeric>: The seqnames of second chromosmes
(col in matrix).
If <code>NULL</code> variable will be assigned value of chrom_1 (Defalt NULL).</numeric></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><logical>: Show the progression in console?
(Default FALSE)</logical></p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p><numerical> : An integer to specify the number
of cores. (Default 1)</numerical></p></dd>


<dt id="arg-hic-norm">hic_norm<a class="anchor" aria-label="anchor" href="#arg-hic-norm"></a></dt>
<dd><p><character>: "norm" argument to supply to
<code><a href="https://rdrr.io/pkg/strawr/man/straw.html" class="external-link">strawr::straw()</a></code>.
This argument is for .hic format data only. Available norms can be obtained
through <code><a href="https://rdrr.io/pkg/strawr/man/readHicNormTypes.html" class="external-link">strawr::readHicNormTypes()</a></code>.
(Default "NONE").</character></p></dd>


<dt id="arg-hic-matrix">hic_matrix<a class="anchor" aria-label="anchor" href="#arg-hic-matrix"></a></dt>
<dd><p><character>: "matrix" argument to supply to
<code><a href="https://rdrr.io/pkg/strawr/man/straw.html" class="external-link">strawr::straw()</a></code>.
This argument is for .hic format data only.
Other options can be: "oe", "expected". (Default "observed").</character></p></dd>


<dt id="arg-cool-balanced">cool_balanced<a class="anchor" aria-label="anchor" href="#arg-cool-balanced"></a></dt>
<dd><p><logical> Import already balanced matrix?
(Default: FALSE)</logical></p></dd>


<dt id="arg-cool-weight-name">cool_weight_name<a class="anchor" aria-label="anchor" href="#arg-cool-weight-name"></a></dt>
<dd><p><character> Name of the correcter in
the cool file. (Default: weight).
<code><a href="https://rdrr.io/pkg/rhdf5/man/h5ls.html" class="external-link">rhdf5::h5ls()</a></code> to see the available correctors.</character></p></dd>


<dt id="arg-cool-divisive-weights">cool_divisive_weights<a class="anchor" aria-label="anchor" href="#arg-cool-divisive-weights"></a></dt>
<dd><p><logical> Does the correcter
vector contain divisive biases as in hicExplorer or multiplicative as in
cooltools? (Default: FALSE)</logical></p></dd>


<dt id="arg-h-fill-upper">h5_fill_upper<a class="anchor" aria-label="anchor" href="#arg-h-fill-upper"></a></dt>
<dd><p><logical> Do the matrix in h5 format
need to be transposed? (Default: TRUE)</logical></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrices list.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>ImportHiC</p>
<p>If you request "expected" values when importing .hic format data,
you must do yourself the "oe" by importing manually the observed counts
as well.</p>
<p>Prior to v.0.9.0 cooltools had multiplicative weight only, so make sure
your correcters are divisive or multiplicative.
https://cooler.readthedocs.io/en/stable/releasenotes.html#v0-9-0</p>
<p>When loading hic matrix in h5 format make sure you have enough momory
to load the full matrix with all chromosomes regardless of values for
chrom_1 and chrom_2 arguments. The function first loads the whole matrix,
then extracts matrices per chromosome for the time being, it's easier ;).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prepare Temp Directory</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>timeout <span class="op">=</span> <span class="fl">3600</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">temp.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"HIC_DATA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">temp.dir</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Download .hic file</span></span></span>
<span class="r-in"><span><span class="va">Hic.url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"https://4dn-open-data-public.s3.amazonaws.com/"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"fourfront-webprod/wfoutput/"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"7386f953-8da9-47b0-acb2-931cba810544/4DNFIOTPSS3L.hic"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">HicOutput.pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp.dir</span>, <span class="st">"Control_HIC.hic"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">HicOutput.pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="va">HicOutput.pth</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[1]="/tmp/Rtmppr5VCj/HIC_DATA/Control_HIC.hic": No such file or directory</span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">Hic.url</span>, <span class="va">HicOutput.pth</span>, method <span class="op">=</span> <span class="st">"auto"</span>,</span></span>
<span class="r-in"><span>    extra <span class="op">=</span> <span class="st">"-k"</span>,mode<span class="op">=</span><span class="st">"wb"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">Hic.url</span>, <span class="va">HicOutput.pth</span>, method <span class="op">=</span> <span class="st">"auto"</span>, extra <span class="op">=</span> <span class="st">"-k"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Import .hic file</span></span></span>
<span class="r-in"><span><span class="va">HiC_Ctrl.cmx_lst</span> <span class="op">&lt;-</span> <span class="fu">ImportHiC</span><span class="op">(</span></span></span>
<span class="r-in"><span>    file <span class="op">=</span> <span class="va">HicOutput.pth</span>,</span></span>
<span class="r-in"><span>    hicResolution <span class="op">=</span> <span class="fl">100000</span>,</span></span>
<span class="r-in"><span>    chrom_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span>, <span class="st">"2L"</span>, <span class="st">"2R"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    chrom_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span>, <span class="st">"2R"</span>, <span class="st">"2R"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Download .mcool file</span></span></span>
<span class="r-in"><span><span class="va">Mcool.url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"https://4dn-open-data-public.s3.amazonaws.com/"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"fourfront-webprod/wfoutput/"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"4f1479a2-4226-4163-ba99-837f2c8f4ac0/4DNFI8DRD739.mcool"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">McoolOutput.pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp.dir</span>, <span class="st">"HeatShock_HIC.mcool"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">HicOutput.pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="va">McoolOutput.pth</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[1]="/tmp/Rtmppr5VCj/HIC_DATA/HeatShock_HIC.mcool": No such file or directory</span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">Mcool.url</span>, <span class="va">McoolOutput.pth</span>, method <span class="op">=</span> <span class="st">"auto"</span>,</span></span>
<span class="r-in"><span>    extra <span class="op">=</span> <span class="st">"-k"</span>,mode<span class="op">=</span><span class="st">"wb"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">Mcool.url</span>, <span class="va">McoolOutput.pth</span>, method <span class="op">=</span> <span class="st">"auto"</span>,</span></span>
<span class="r-in"><span>    extra <span class="op">=</span> <span class="st">"-k"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Import .mcool file</span></span></span>
<span class="r-in"><span><span class="va">HiC_HS.cmx_lst</span> <span class="op">&lt;-</span> <span class="fu">ImportHiC</span><span class="op">(</span></span></span>
<span class="r-in"><span>    file <span class="op">=</span> <span class="va">McoolOutput.pth</span>,</span></span>
<span class="r-in"><span>    hicResolution <span class="op">=</span> <span class="fl">100000</span>,</span></span>
<span class="r-in"><span>    chrom_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span>, <span class="st">"2L"</span>, <span class="st">"2R"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    chrom_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span>, <span class="st">"2R"</span>, <span class="st">"2R"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># Import .h5 file</span></span></span>
<span class="r-in"><span><span class="va">h5_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Control_HIC_10k_2L.h5"</span>,</span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"HicAggR"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">binSize</span><span class="op">=</span><span class="fl">10000</span></span></span>
<span class="r-in"><span><span class="va">hicLst</span> <span class="op">&lt;-</span> <span class="fu">ImportHiC</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file      <span class="op">=</span> <span class="va">h5_path</span>,</span></span>
<span class="r-in"><span>  hicResolution       <span class="op">=</span> <span class="va">binSize</span>,</span></span>
<span class="r-in"><span>  chromSizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>seqnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  seqlengths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">23513712</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  chrom_1   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robel Tesfaye, David Depierre, Nicolas Chanard, Stephane Schaak, Olivier Cuvier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

