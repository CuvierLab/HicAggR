<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>CompareToBackground — CompareToBackground • HicAggR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="CompareToBackground — CompareToBackground"><meta name="description" content="Computes z.test for each target couple over background couples."><meta property="og:description" content="Computes z.test for each target couple over background couples."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HicAggR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/HicAggR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/InDepth.html">HicAggR - In depth tutorial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CuvierLab/HicAggR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>CompareToBackground</h1>
      <small class="dont-index">Source: <a href="https://github.com/CuvierLab/HicAggR/blob/master/R/compare_to_background.R" class="external-link"><code>R/compare_to_background.R</code></a></small>
      <div class="d-none name"><code>compareToBackground.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes z.test for each target couple over background couples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CompareToBackground</span><span class="op">(</span></span>
<span>  hicList <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  matrices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indexAnchor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indexBait <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genomicConstraint <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  secondaryConst.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chromSizes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_background <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  areaFun <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  operationFun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  bg_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  p_adj_method <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-hiclist">hicList<a class="anchor" aria-label="anchor" href="#arg-hiclist"></a></dt>
<dd><p>&lt;List<a href="https://rdrr.io/pkg/InteractionSet/man/ContactMatrix-class.html" class="external-link">ContactMatrix</a>&gt;:
The HiC maps list.</p></dd>


<dt id="arg-matrices">matrices<a class="anchor" aria-label="anchor" href="#arg-matrices"></a></dt>
<dd><p>&lt;list<a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a>&gt;: The matrices list.</p></dd>


<dt id="arg-indexanchor">indexAnchor<a class="anchor" aria-label="anchor" href="#arg-indexanchor"></a></dt>
<dd><p><granges>: A first indexed GRanges object
used as pairs anchor (must be indexed using <code><a href="IndexFeatures.html">IndexFeatures()</a></code>).</granges></p></dd>


<dt id="arg-indexbait">indexBait<a class="anchor" aria-label="anchor" href="#arg-indexbait"></a></dt>
<dd><p><granges>: A second indexed GRanges object
used as pairs bait (must be indexed using <code><a href="IndexFeatures.html">IndexFeatures()</a></code>).</granges></p></dd>


<dt id="arg-genomicconstraint">genomicConstraint<a class="anchor" aria-label="anchor" href="#arg-genomicconstraint"></a></dt>
<dd><p><granges>: GRanges object of
constraint regions. If <code>NULL</code>, chromosomes in chromSizes are used as
constraints (Default NULL)</granges></p></dd>


<dt id="arg-secondaryconst-var">secondaryConst.var<a class="anchor" aria-label="anchor" href="#arg-secondaryconst-var"></a></dt>
<dd><p><character>: A string defining
column name containing compartment information in the
metadata of anchor and bait <granges> objects. (Default NULL)</granges></character></p></dd>


<dt id="arg-chromsizes">chromSizes<a class="anchor" aria-label="anchor" href="#arg-chromsizes"></a></dt>
<dd><p>&lt;data.frame&gt;: A data.frame containing chromosomes
names and lengths in base pairs.</p></dd>


<dt id="arg-n-background">n_background<a class="anchor" aria-label="anchor" href="#arg-n-background"></a></dt>
<dd><p><integer> : Number of background
couples to keep. We recommend to use <code>set.seed</code> prior to launching
this function with non null n_background. (Default NULL)</integer></p></dd>


<dt id="arg-areafun">areaFun<a class="anchor" aria-label="anchor" href="#arg-areafun"></a></dt>
<dd><p><character or function>: A character
or function that allows to extract an area from each matrix that
composes the matrices list (Default "center").
Look at <a href="GetQuantif.html">GetQuantif</a> for more info.</character></p></dd>


<dt id="arg-operationfun">operationFun<a class="anchor" aria-label="anchor" href="#arg-operationfun"></a></dt>
<dd><p><character or function>: A character
or function specifying the operation applied to the selected area.
(Default "mean").
Look at <a href="GetQuantif.html">GetQuantif</a> for more info.</character></p></dd>


<dt id="arg-bg-type">bg_type<a class="anchor" aria-label="anchor" href="#arg-bg-type"></a></dt>
<dd><p><character>: Type of background couples
to generate. Possible choices: "random_anchors", "inter_TAD",
"inter_compartment", NULL (Defaults to "random_anchors").
More information in details...</character></p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p><integer> : Number of cores used. (Default 1)</integer></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><logical> details on progress? (Default: FALSE)</logical></p></dd>


<dt id="arg-p-adj-method">p_adj_method<a class="anchor" aria-label="anchor" href="#arg-p-adj-method"></a></dt>
<dd><p><character> method used
to adjust p.values. More from <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">stats::p.adjust()</a></code>. (Default: "BH")</character></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments to pass to <a href="PrepareMtxList.html">PrepareMtxList</a>, inorder to treat
background matrices.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>returns a <list> object with the z.test output for each
target couple, values for the target couples and values for the
background couples.</list></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Types of background couples possible:</p><ul><li><p>"random_anchors": picks random bins as anchors and forms couples
with bait bins.
If genomicConstraint is supplied, only intra-TAD random-bait couples are
kept.
Else intra-TAD random-bait couples within a distance constraint
corresponding to the minimal and maximal distances of target couples.</p></li>
<li><p>"inter_TAD": If target couples were formed using TAD information
with non <code>NULL</code>
genomicConstraint argument, then inter-TAD anchor-bait couples are used
as background.
Distance constraint applied correspond to the minimal distance of target
couples and
maximal width of supplied TADs.</p></li>
<li><p>"inter_compartment": If <code>secondaryConst.var</code> is not
<code>NULL</code> and both indexAnchor and indexBait objects contain the
provided variable name, then background couples are formed between anchors
and baits located in different compartments.</p></li>
<li><p>"NULL": If <code>NULL</code>, <code>random_anchors</code> are set by default.</p></li>
</ul><p>Notes on the comparison between bg and target couples:
We noticed that o/e values tend to be
skewed towards very long distance interactions. As a result, long
distance background couples tend to influence strongly mean and sd,
resulting in more long distance target couples being significant.
So rather than computing z.score over all background couples,
we've chosen to fit a polynomial with 2 degrees on the log(counts)
vs distance data of the background couples. Z.scores are then
computed per target couple by comparing residuals of the target counts
as predicted by the model and the residuals of the background couples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">h5_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Control_HIC_10k_2L.h5"</span>,</span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"HicAggR"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">binSize</span><span class="op">=</span><span class="fl">10000</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Beaf32_Peaks.gnr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">TADs_Domains.gnr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hicLst</span> <span class="op">&lt;-</span> <span class="fu"><a href="ImportHiC.html">ImportHiC</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  file      <span class="op">=</span> <span class="va">h5_path</span>,</span></span>
<span class="r-in"><span>  hicResolution       <span class="op">=</span> <span class="va">binSize</span>,</span></span>
<span class="r-in"><span>  chromSizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>seqnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  seqlengths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">23513712</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  chrom_1   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hicLst</span> <span class="op">&lt;-</span> <span class="fu"><a href="BalanceHiC.html">BalanceHiC</a></span><span class="op">(</span><span class="va">hicLst</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hicLst</span> <span class="op">&lt;-</span> <span class="fu"><a href="OverExpectedHiC.html">OverExpectedHiC</a></span><span class="op">(</span><span class="va">hicLst</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="compareToBackground-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Index Beaf32</span></span></span>
<span class="r-in"><span><span class="va">Beaf32_Index.gnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="IndexFeatures.html">IndexFeatures</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  gRangeList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Beaf <span class="op">=</span> <span class="va">Beaf32_Peaks.gnr</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  chromSizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>seqnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>   seqlengths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">23513712</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  genomicConstraint <span class="op">=</span> <span class="va">TADs_Domains.gnr</span>,</span></span>
<span class="r-in"><span>  binSize <span class="op">=</span> <span class="va">binSize</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Beaf_Beaf.gni</span> <span class="op">&lt;-</span> <span class="fu"><a href="SearchPairs.html">SearchPairs</a></span><span class="op">(</span>indexAnchor <span class="op">=</span> <span class="va">Beaf32_Index.gnr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">interactions_Ctrl.mtx_lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> genomicFeature <span class="op">=</span> <span class="va">Beaf_Beaf.gni</span>,</span></span>
<span class="r-in"><span> hicLst <span class="op">=</span> <span class="va">hicLst</span>,</span></span>
<span class="r-in"><span> referencePoint <span class="op">=</span> <span class="st">"pf"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">interactions_Ctrl.mtx_lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="PrepareMtxList.html">PrepareMtxList</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> matrices <span class="op">=</span> <span class="va">interactions_Ctrl.mtx_lst</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">output_bgInterTAD</span> <span class="op">=</span> <span class="fu">CompareToBackground</span><span class="op">(</span>hicList <span class="op">=</span> <span class="va">hicLst</span>,</span></span>
<span class="r-in"><span> matrices <span class="op">=</span> <span class="va">interactions_Ctrl.mtx_lst</span>,</span></span>
<span class="r-in"><span> indexAnchor <span class="op">=</span> <span class="va">Beaf32_Index.gnr</span>,</span></span>
<span class="r-in"><span> indexBait <span class="op">=</span> <span class="va">Beaf32_Index.gnr</span>,</span></span>
<span class="r-in"><span> genomicConstraint <span class="op">=</span> <span class="va">TADs_Domains.gnr</span>,</span></span>
<span class="r-in"><span> chromSizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>seqnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>   seqlengths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">23513712</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> bg_type<span class="op">=</span><span class="st">"inter_TAD"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robel Tesfaye, David Depierre, Nicolas Chanard, Stephane Schaak, Olivier Cuvier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

