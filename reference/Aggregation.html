<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregation of matrices list. — Aggregation • HicAggR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregation of matrices list. — Aggregation"><meta name="description" content="Aggregates all the matrices of a list (or two lists in case
of differential aggregation) into a single matrix. This function allows
to apply different aggregation (average, sum, ...), and
differential (subtraction, ratio, ...) functions."><meta property="og:description" content="Aggregates all the matrices of a list (or two lists in case
of differential aggregation) into a single matrix. This function allows
to apply different aggregation (average, sum, ...), and
differential (subtraction, ratio, ...) functions."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HicAggR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/HicAggR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/InDepth.html">HicAggR - In depth tutorial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CuvierLab/HicAggR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Aggregation of matrices list.</h1>
      <small class="dont-index">Source: <a href="https://github.com/CuvierLab/HicAggR/blob/master/R/Aggregation.R" class="external-link"><code>R/Aggregation.R</code></a></small>
      <div class="d-none name"><code>Aggregation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Aggregates all the matrices of a list (or two lists in case
of differential aggregation) into a single matrix. This function allows
to apply different aggregation (average, sum, ...), and
differential (subtraction, ratio, ...) functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Aggregation</span><span class="op">(</span></span>
<span>  ctrlMatrices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  matrices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggFun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  diffFun <span class="op">=</span> <span class="st">"substraction"</span>,</span>
<span>  scaleCorrection <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  correctionArea <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  statCompare <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ctrlmatrices">ctrlMatrices<a class="anchor" aria-label="anchor" href="#arg-ctrlmatrices"></a></dt>
<dd><p>&lt;list<a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a>&gt;: The matrices list to aggregate as
control.</p></dd>


<dt id="arg-matrices">matrices<a class="anchor" aria-label="anchor" href="#arg-matrices"></a></dt>
<dd><p>&lt;list<a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a>&gt;: The matrices list to aggregate.</p></dd>


<dt id="arg-aggfun">aggFun<a class="anchor" aria-label="anchor" href="#arg-aggfun"></a></dt>
<dd><p><function or chracter>: The function used
to aggregate each pixel in matrix.
If the parameter is a character so:</function></p><ul><li><p>"50%" or "median" apply the median</p></li>
<li><p>"+" or "sum" apply the sum</p></li>
<li><p>other (Default) apply the mean</p></li>
</ul></dd>


<dt id="arg-difffun">diffFun<a class="anchor" aria-label="anchor" href="#arg-difffun"></a></dt>
<dd><p><function or chracter>: The function used
to compute differential. If the parameter is character so:</function></p><ul><li><p>"-", "substract" or "substraction" apply a substraction (Default)</p></li>
<li><p>"/" or "ratio" apply a ratio</p></li>
<li><p>"log2","log2-","log2/" or "log2ratio" apply a log2 on ratio</p></li>
<li><p>other apply a log2 on 1+ratio</p></li>
</ul></dd>


<dt id="arg-scalecorrection">scaleCorrection<a class="anchor" aria-label="anchor" href="#arg-scalecorrection"></a></dt>
<dd><p><logical>: Whether a correction
should be done on the median value take in ane noising area.
(Default TRUE)</logical></p></dd>


<dt id="arg-correctionarea">correctionArea<a class="anchor" aria-label="anchor" href="#arg-correctionarea"></a></dt>
<dd><p><list>: Nested list of indice
that define a noising area fore correction. List must
contain in first an element "i" (row indices) then an
element called "j" (columns indices). If NULL automatically
take in upper left part of aggregated matrices. (Default NULL)</list></p></dd>


<dt id="arg-statcompare">statCompare<a class="anchor" aria-label="anchor" href="#arg-statcompare"></a></dt>
<dd><p><logical>: Whether a t.test must be apply
to each pixel of the differential aggregated matrix.</logical></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Aggregation</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Beaf32_Peaks.gnr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">HiC_Ctrl.cmx_lst</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">HiC_HS.cmx_lst</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Index Beaf32</span></span></span>
<span class="r-in"><span><span class="va">Beaf32_Index.gnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="IndexFeatures.html">IndexFeatures</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    gRangeList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Beaf <span class="op">=</span> <span class="va">Beaf32_Peaks.gnr</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    chromSizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>seqnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L"</span>, <span class="st">"2R"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        seqlengths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">23513712</span>, <span class="fl">25286936</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    binSize <span class="op">=</span> <span class="fl">100000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Beaf32 &lt;-&gt; Beaf32 Pairing</span></span></span>
<span class="r-in"><span><span class="va">Beaf_Beaf.gni</span> <span class="op">&lt;-</span> <span class="fu"><a href="SearchPairs.html">SearchPairs</a></span><span class="op">(</span>indexAnchor <span class="op">=</span> <span class="va">Beaf32_Index.gnr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># subset 2000 first for exemple</span></span></span>
<span class="r-in"><span><span class="va">Beaf_Beaf.gni</span> <span class="op">&lt;-</span> <span class="va">Beaf_Beaf.gni</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Matrices extractions center on Beaf32 &lt;-&gt; Beaf32 point interaction</span></span></span>
<span class="r-in"><span><span class="va">interactions_Ctrl.mtx_lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    genomicFeature <span class="op">=</span> <span class="va">Beaf_Beaf.gni</span>,</span></span>
<span class="r-in"><span>    hicLst <span class="op">=</span> <span class="va">HiC_Ctrl.cmx_lst</span>,</span></span>
<span class="r-in"><span>    referencePoint <span class="op">=</span> <span class="st">"pf"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">interactions_HS.mtx_lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    genomicFeature <span class="op">=</span> <span class="va">Beaf_Beaf.gni</span>,</span></span>
<span class="r-in"><span>    hicLst <span class="op">=</span> <span class="va">HiC_HS.cmx_lst</span>,</span></span>
<span class="r-in"><span>    referencePoint <span class="op">=</span> <span class="st">"pf"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">interactions_Ctrl.mtx_lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="PrepareMtxList.html">PrepareMtxList</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    matrices <span class="op">=</span> <span class="va">interactions_Ctrl.mtx_lst</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Aggregate matrices in one matrix</span></span></span>
<span class="r-in"><span><span class="va">aggreg.mtx</span> <span class="op">&lt;-</span> <span class="fu">Aggregation</span><span class="op">(</span><span class="va">interactions_Ctrl.mtx_lst</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">interactions_HS.mtx_lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="PrepareMtxList.html">PrepareMtxList</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    matrices <span class="op">=</span> <span class="va">interactions_HS.mtx_lst</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Differential Aggregation</span></span></span>
<span class="r-in"><span><span class="va">aggregDiff.mtx</span> <span class="op">&lt;-</span> <span class="fu">Aggregation</span><span class="op">(</span></span></span>
<span class="r-in"><span>    ctrlMatrices <span class="op">=</span> <span class="va">interactions_Ctrl.mtx_lst</span>,</span></span>
<span class="r-in"><span>    matrices <span class="op">=</span> <span class="va">interactions_HS.mtx_lst</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robel Tesfaye, David Depierre, Nicolas Chanard, Stephane Schaak, Olivier Cuvier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

